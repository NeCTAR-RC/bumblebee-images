{
  "builders": [
    {
      "type": "openstack",
      "flavor": "m3.small",
      "image_name": "Fedora Scientific",
      "source_image_filter": {
        "filters": {
          "name": "NeCTAR Fedora 36 x86_64",
          "visibility": "public"
        }
      },
      "availability_zone": "melbourne-qh2",
      "ssh_username": "fedora",
      "ssh_keypair_name": "packer-ssh-key",
      "ssh_private_key_file": "packer-ssh-key",
      "security_groups": ["image-build"]
    }
  ],
  "provisioners": [
    {
      "type": "ansible",
      "playbook_file": "ansible/playbook-fedora-scientific.yml",
      "extra_arguments": [
        "--extra-vars",
        "image_name='Fedora Scientific'"
      ]
    },
    {
      "type": "shell",
      "execute_command": "{{.Vars}} sudo -S -E bash '{{.Path}}'",
      "script": "scripts/cleanup.sh"
    }
  ]
}

